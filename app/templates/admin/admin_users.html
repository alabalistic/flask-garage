{% extends "layout.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Управление на потребители</h2>
    <div class="d-flex justify-content-between mb-3">
        <a href="{{ url_for('create_user') }}" class="btn btn btn-primary">Създай нов потребител</a>
        <form class="form-inline" action="{{ url_for('search_users') }}" method="GET">
            <input class="form-control mr-sm-2" type="search" placeholder="Търсене" aria-label="Търси" name="query">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Търси</button>
        </form>
    </div>
    <ul class="list-group">
        {% for user in users %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ user.username }}</strong> - {{ user.phone_number }} - 
                    {% if user.roles %}
                        {{ user.roles[0].name }}
                    {% else %}
                        No Role Assigned
                    {% endif %}
                </div>
                <div>
                    <a href="{{ url_for('edit_user', user_id=user.id) }}" class="btn btn-outline-secondary btn-sm">Редактирай</a>
                    <form action="{{ url_for('delete_user', user_id=user.id) }}" method="POST" style="display:inline;">
                        <button type="submit" class="btn btn-outline-danger btn-sm">Изтрий</button>
                    </form>
                </div>
            </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
